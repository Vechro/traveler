routes:
  # -
  #   uri: /auth/v1/verify
  #   upstream:
  #     type: roundrobin
  #     nodes:
  #       "auth:9999/verify": 1
  #   plugins:
  #     proxy-rewrite:
  #       uri: /verify
  # -
  #   uri: /auth/v1/callback
  #   upstream:
  #     type: roundrobin
  #     nodes:
  #       "auth:9999/callback": 1
  #   plugins:
  #     proxy-rewrite:
  #       uri: /callback
  # -
  #   uri: /auth/v1/authorize
  #   upstream:
  #     type: roundrobin
  #     nodes:
  #       "auth:9999/authorize": 1
  #   plugins:
  #     proxy-rewrite:
  #       uri: /authorize

  -
    uri: /rest/v1/*
    priority: 100
    upstream:
      nodes:
        "rest:3000": 1
      type: roundrobin
    plugins:
      proxy-rewrite:
        regex_uri: ["^/rest/v1/(.*)","/$1"]

  -
    uri: /auth/v1/*
    priority: 100
    upstream:
      nodes:
        "auth:9999": 1
      type: roundrobin
    plugins:
      proxy-rewrite:
        regex_uri: ["^/auth/v1/(.*)","/$1"]

  -
    uri: /storage/v1/*
    priority: 100
    upstream:
      nodes:
        "storage:5000": 1
      type: roundrobin
    plugins:
      proxy-rewrite:
        regex_uri: ["^/storage/v1/(.*)","/$1"]

  -
    uri: /:path
    upstream:
      nodes:
        "host.docker.internal:5173": 1
      type: roundrobin

  -
    uri: /:path/*
    upstream:
      nodes:
        "host.docker.internal:5173": 1
      type: roundrobin

#END
