upstreams:
  - id: rest
    nodes:
      "rest:3000": 1
    type: roundrobin

  - id: storage
    nodes:
      "storage:5000": 1
    type: roundrobin

  - id: orbit
    nodes:
      "host.docker.internal:5173": 1
    type: roundrobin

  - id: auth
    nodes:
      "auth:9999": 1
    type: roundrobin

routes:
  - uri: /rest/v1/*
    upstream_id: rest
    plugins:
      proxy-rewrite:
        regex_uri: ["^/rest/v1/(.*)", "/$1"]

  - uri: /storage/v1/*
    upstream_id: storage
    plugins:
      proxy-rewrite:
        regex_uri: ["^/storage/v1/(.*)", "/$1"]

  - uri: /auth/v1/*
    upstream_id: auth
    plugins:
      proxy-rewrite:
        regex_uri: ["^/auth/v1/(.*)", "/$1"]

  - uri: /*
    upstream_id: orbit
#END
